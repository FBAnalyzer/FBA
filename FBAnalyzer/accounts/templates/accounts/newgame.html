<!--

This is the New Game Analysis - html - page content file. It contains all the functionality of game analysis.
It extends app_layout.html with Django

-->

{% extends 'app_layout.html' %}
{% block content %}

<div class="container" style="Padding-top: 40px;">
    <div class="row">
        <div class="col-sm-4">
            <div class="team-selection">
                <h2>Team 1</h2>
                <form>
                    <textarea id="home_team" name="hometeam" rows="1" placeholder="Your team name" maxlength="20" wrap="off"></textarea>
                </form>
            </div>
        </div>
        <div class="col-sm-4">
            <div class="game-clock">
                <h4 id="periodNr">Period 1</h4>
                <h2 id="label">00:00:00</h2>
            </div>
            <div class="game-btn" role="group" aria-label="Game buttons">
                <button id="reset" type="button" onclick="Reset()" disabled="true" class="btn btn-secondary">Reset</button>
                <button id="start" type="button" onclick="Start()" class="btn btn-secondary btn-lg">Start game</button>
                <button id="period" type="button" onclick="Period()" disabled="true" class="btn btn-secondary">Period</button>
            </div>
        </div>
        <div class="col-sm-4">
            <div class="team-selection">
                <h2>Team 2</h2>
                <form>
                    <textarea id="away_team" name="awayteam" rows="1" placeholder="Opponent team name" maxlength="20" wrap="off"></textarea>
                </form>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-4">
            <div class="shot-map">
            <p>Shot mapping</p>
            <canvas id="myCanvas" onmousedown="GetCoordinates()" width="284" height="200"></canvas>
            </div>
        </div>
        <div class="col-sm-4">
            <div class="button-input">
                <p>Line on court</p>
                <div class="line-btn btn-group-lg" role="group" aria-label="Line buttons">
                    <button id="L1" type="button" style="background-color: #555555" onclick="Line_change(1)" class="btn btn-secondary">Line 1</button>
                    <button id="L2" type="button" onclick="Line_change(2)" class="btn btn-secondary">Line 2</button>
                    <button id="L3" type="button" onclick="Line_change(3)" class="btn btn-secondary">Line 3</button>
                </div>
                <div class="line-btn" role="group" aria-label="Line buttons">
                    <button id="Pp1" type="button" onclick="Line_change(4)" class="btn btn-secondary">PP 1</button>
                    <button id="Pp2" type="button" onclick="Line_change(5)" class="btn btn-secondary">PP 2</button>
                    <button id="Sh1" type="button" onclick="Line_change(6)" class="btn btn-secondary">SH 1</button>
                    <button id="Sh2" type="button" onclick="Line_change(7)" class="btn btn-secondary">SH 2</button>
                </div>
            </div>
        </div>
        <div class="col-sm-4">
            <div class="pos-input">
                <p>Position</p>
                {% load static %}
                <input type="image" id="changeorder" onclick="ChangeOrder()" src="{% static 'change_icon.jpeg' %}" width="30" height="30" alt="order">
                <div class="pos-btn btn-group-lg" role="group" aria-label="Position buttons">
                    <button id="TeamL" type="button" style="background-color: #555555" onclick="BallTeamL()" class="btn btn-secondary">Team 1</button>
                    <button id="TeamR" type="button" onclick="BallTeamR()" class="btn btn-secondary">Team 2</button>
                </div>
                <div class="zone-btn btn-group-lg btn-group-lg" role="group" aria-label="Zone buttons">
                    <button id="ZoneL" type="button" style="background-color: #555555" onclick="BallZoneL()" class="btn btn-secondary">Defence</button>
                    <button id="ZoneR" type="button" onclick="BallZoneR()" class="btn btn-secondary">Attack</button>
                </div>
                <p>Incidents</p>
                <div class="inc-btn btn-group-lg btn-group-lg" role="group" aria-label="Incident buttons">
                    <button id="OtS" type="button" onclick="ScoringOpp()" class="btn btn-secondary">Scoring Opportunity</button>
                    <button id="OmR" type="button" onclick="OddManRush()" class="btn btn-secondary">Odd Man Rush</button>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-3">
            <div id="sL1" class="stats-L1">
                <h4><hr/>Line 1</h4>
                <p style="padding-top: 10px"><b>Possession:</b> <span id="pL1">0</span>% | <span id="pL1g">0</span>%<p/>
                <p>Time on Court: <span id="tocL1">0:00</span> | <span id="tocL1g">0:00</span></p>
                <p style="padding-top: 10px"><b>Team 1 Shots</b></p>
                <p>Shots: <span id="sfL1">0</span> | <span id="sfL1g">0</span></p>
                <p>Blocked: <span id="baL1">0</span> | <span id="baL1g">0</span></p>
                <p>Missed: <span id="mfL1">0</span> | <span id="mfL1g">0</span></p>
                <p>Saved: <span id="safL1">0</span> | <span id="safL1g">0</span></p>
                <p>Goals: <span id="gfL1">0</span> | <span id="gfL1g">0</span></p>
                <p style="padding-top: 10px"><b>Team 2 Shots</b></p>
                <p>Shots: <span id="saL1">0</span> | <span id="saL1g">0</span></p>
                <p>Blocked: <span id="bfL1">0</span> | <span id="bfL1g">0</span></p>
                <p>Missed: <span id="maL1">0</span> | <span id="maL1g">0</span></p>
                <p>Saved: <span id="saaL1">0</span> | <span id="saaL1g">0</span></p>
                <p>Goals: <span id="gaL1">0</span> | <span id="gaL1g">0</span></p>
                <p style="padding-top: 10px"><b>Plus minus:</b> <span id="pmL1">0</span> | <span id="pmL1g">0</span></p>
            </div>
        </div>
        <div class="col-sm-3">
            <div id="sL2" class="stats-L2">
                <h4><hr/>Line 2</h4>
                <p style="padding-top: 10px"><b>Possession:</b> <span id="pL2">0</span>% | <span id="pL2g">0</span>%<p/>
                <p>Time on Court: <span id="tocL2">0:00</span> | <span id="tocL2g">0:00</span></p>
                <p style="padding-top: 10px"><b>Team 1 Shots</b></p>
                <p>Shots: <span id="sfL2">0</span> | <span id="sfL2g">0</span></p>
                <p>Blocked: <span id="baL2">0</span> | <span id="baL2g">0</span></p>
                <p>Missed: <span id="mfL2">0</span> | <span id="mfL2g">0</span></p>
                <p>Saved: <span id="safL2">0</span> | <span id="safL2g">0</span></p>
                <p>Goals: <span id="gfL2">0</span> | <span id="gfL2g">0</span></p>
                <p style="padding-top: 10px"><b>Team 2 Shots</b></p>
                <p>Shots: <span id="saL2">0</span> | <span id="saL2g">0</span></p>
                <p>Blocked: <span id="bfL2">0</span> | <span id="bfL2g">0</span></p>
                <p>Missed: <span id="maL2">0</span> | <span id="maL2g">0</span></p>
                <p>Saved: <span id="saaL2">0</span> | <span id="saaL2g">0</span></p>
                <p>Goals: <span id="gaL2">0</span> | <span id="gaL2g">0</span></p>
                <p style="padding-top: 10px"><b>Plus minus:</b> <span id="pmL2">0</span> | <span id="pmL2g">0</span></p>
            </div>
        </div>
        <div class="col-sm-3">
            <div id="sL3" class="stats-L3">
                <h4><hr/>Line 3</h4>
                <p style="padding-top: 10px"><b>Possession:</b> <span id="pL3">0</span>% | <span id="pL3g">0</span>%<p/>
                <p>Time on Court: <span id="tocL3">0:00</span> | <span id="tocL3g">0:00</span></p>
                <p style="padding-top: 10px"><b>Team 1 Shots</b></p>
                <p>Shots: <span id="sfL3">0</span> | <span id="sfL3g">0</span></p>
                <p>Blocked: <span id="baL3">0</span> | <span id="baL3g">0</span></p>
                <p>Missed: <span id="mfL3">0</span> | <span id="mfL3g">0</span></p>
                <p>Saved: <span id="safL3">0</span> | <span id="safL3g">0</span></p>
                <p>Goals: <span id="gfL3">0</span> | <span id="gfL3g">0</span></p>
                <p style="padding-top: 10px"><b>Team 2 Shots</b></p>
                <p>Shots: <span id="saL3">0</span> | <span id="saL3g">0</span></p>
                <p>Blocked: <span id="bfL3">0</span> | <span id="bfL3g">0</span></p>
                <p>Missed: <span id="maL3">0</span> | <span id="maL3g">0</span></p>
                <p>Saved: <span id="saaL3">0</span> | <span id="saaL3g">0</span></p>
                <p>Goals: <span id="gaL3">0</span> | <span id="gaL3g">0</span></p>
                <p style="padding-top: 10px"><b>Plus minus:</b> <span id="pmL3">0</span> | <span id="pmL3g">0</span></p>
            </div>
        </div>
        <div class="col-sm-3">
            <div id="sTeam" class="stats-Team">
                <h4><hr/>Team</h4>
                <p style="padding-top: 10px"><b>Possession:</b> <span id="pTeam">0</span>% | <span id="pTeamg">0</span>%<p/>
                <p>Time on Court: <span id="tocTeam">0:00</span> | <span id="tocTeamg">0:00</span></p>
                <p style="padding-top: 10px"><b>Team 1 Shots</b></p>
                <p>Shots: <span id="sfTeam">0</span> | <span id="sfTeamg">0</span></p>
                <p>Blocked: <span id="baTeam">0</span> | <span id="baTeamg">0</span></p>
                <p>Missed: <span id="mfTeam">0</span> | <span id="mfTeamg">0</span></p>
                <p>Saved: <span id="safTeam">0</span> | <span id="safTeamg">0</span></p>
                <p>Goals: <span id="gfTeam">0</span> | <span id="gfTeamg">0</span></p>
                <p style="padding-top: 10px"><b>Team 2 Shots</b></p>
                <p>Shots: <span id="saTeam">0</span> | <span id="saTeamg">0</span></p>
                <p>Blocked: <span id="bfTeam">0</span> | <span id="bfTeamg">0</span></p>
                <p>Missed: <span id="maTeam">0</span> | <span id="maTeamg">0</span></p>
                <p>Saved: <span id="saaTeam">0</span> | <span id="saaTeamg">0</span></p>
                <p>Goals: <span id="gaTeam">0</span> | <span id="gaTeamg">0</span></p>
                <p style="padding-top: 10px"><b>Plus minus:</b> <span id="pmTeam">0</span> | <span id="pmTeamg">0</span></p>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-3">
            <div id="sPP1" class="stats-PP1">
                <h4><hr/>Powerplay 1</h4>
                <p style="padding-top: 10px"><b>Possession:</b> <span id="pPP1">0</span>% | <span id="pPP1g">0</span>%<p/>
                <p>Time on Court: <span id="tocPP1">0:00</span> | <span id="tocPP1g">0:00</span></p>
                <p style="padding-top: 10px"><b>Team 1 Shots</b></p>
                <p>Shots: <span id="sfPP1">0</span> | <span id="sfPP1g">0</span></p>
                <p>Blocked: <span id="baPP1">0</span> | <span id="baPP1g">0</span></p>
                <p>Missed: <span id="mfPP1">0</span> | <span id="mfPP1g">0</span></p>
                <p>Saved: <span id="safPP1">0</span> | <span id="safPP1g">0</span></p>
                <p>Goals: <span id="gfPP1">0</span> | <span id="gfPP1g">0</span></p>
                <p style="padding-top: 10px"><b>Team 2 Shots</b></p>
                <p>Shots: <span id="saPP1">0</span> | <span id="saPP1g">0</span></p>
                <p>Blocked: <span id="bfPP1">0</span> | <span id="bfPP1g">0</span></p>
                <p>Missed: <span id="maPP1">0</span> | <span id="maPP1g">0</span></p>
                <p>Saved: <span id="saaPP1">0</span> | <span id="saaPP1g">0</span></p>
                <p>Goals: <span id="gaPP1">0</span> | <span id="gaPP1g">0</span></p>
                <p style="padding-top: 10px"><b>Plus minus:</b> <span id="pmPP1">0</span> | <span id="pmPP1g">0</span></p>
            </div>
        </div>
        <div class="col-sm-3">
            <div id="sPP2" class="stats-PP2">
                <h4><hr/>Powerplay 2</h4>
                <p style="padding-top: 10px"><b>Possession:</b> <span id="pPP2">0</span>% | <span id="pPP2g">0</span>%<p/>
                <p>Time on Court: <span id="tocPP2">0:00</span> | <span id="tocPP2g">0:00</span></p>
                <p style="padding-top: 10px"><b>Team 1 Shots</b></p>
                <p>Shots: <span id="sfPP2">0</span> | <span id="sfPP2g">0</span></p>
                <p>Blocked: <span id="baPP2">0</span> | <span id="baPP2g">0</span></p>
                <p>Missed: <span id="mfPP2">0</span> | <span id="mfPP2g">0</span></p>
                <p>Saved: <span id="safPP2">0</span> | <span id="safPP2g">0</span></p>
                <p>Goals: <span id="gfPP2">0</span> | <span id="gfPP2g">0</span></p>
                <p style="padding-top: 10px"><b>Team 2 Shots</b></p>
                <p>Shots: <span id="saPP2">0</span> | <span id="saPP2g">0</span></p>
                <p>Blocked: <span id="bfPP2">0</span> | <span id="bfPP2g">0</span></p>
                <p>Missed: <span id="maPP2">0</span> | <span id="maPP2g">0</span></p>
                <p>Saved: <span id="saaPP2">0</span> | <span id="saaPP2g">0</span></p>
                <p>Goals: <span id="gaPP2">0</span> | <span id="gaPP2g">0</span></p>
                <p style="padding-top: 10px"><b>Plus minus:</b> <span id="pmPP2">0</span> | <span id="pmPP2g">0</span></p>
            </div>
        </div>
        <div class="col-sm-3">
            <div id="sSH1" class="stats-SH1">
                <h4><hr/>Shorthanded 1</h4>
                <p style="padding-top: 10px"><b>Possession:</b> <span id="pSH1">0</span>% | <span id="pSH1g">0</span>%<p/>
                <p>Time on Court: <span id="tocSH1">0:00</span> | <span id="tocSH1g">0:00</span></p>
                <p style="padding-top: 10px"><b>Team 1 Shots</b></p>
                <p>Shots: <span id="sfSH1">0</span> | <span id="sfSH1g">0</span></p>
                <p>Blocked: <span id="baSH1">0</span> | <span id="baSH1g">0</span></p>
                <p>Missed: <span id="mfSH1">0</span> | <span id="mfSH1g">0</span></p>
                <p>Saved: <span id="safSH1">0</span> | <span id="safSH1g">0</span></p>
                <p>Goals: <span id="gfSH1">0</span> | <span id="gfSH1g">0</span></p>
                <p style="padding-top: 10px"><b>Team 2 Shots</b></p>
                <p>Shots: <span id="saSH1">0</span> | <span id="saSH1g">0</span></p>
                <p>Blocked: <span id="bfSH1">0</span> | <span id="bfSH1g">0</span></p>
                <p>Missed: <span id="maSH1">0</span> | <span id="maSH1g">0</span></p>
                <p>Saved: <span id="saaSH1">0</span> | <span id="saaSH1g">0</span></p>
                <p>Goals: <span id="gaSH1">0</span> | <span id="gaSH1g">0</span></p>
                <p style="padding-top: 10px"><b>Plus minus:</b> <span id="pmSH1">0</span> | <span id="pmSH1g">0</span></p>
            </div>
        </div>
        <div class="col-sm-3">
            <div id="sSH2" class="stats-SH2">
                <h4><hr/>Shorthanded 2</h4>
                <p style="padding-top: 10px"><b>Possession:</b> <span id="pSH2">0</span>% | <span id="pSH2g">0</span>%<p/>
                <p>Time on Court: <span id="tocSH2">0:00</span> | <span id="tocSH2g">0:00</span></p>
                <p style="padding-top: 10px"><b>Team 1 Shots</b></p>
                <p>Shots: <span id="sfSH2">0</span> | <span id="sfSH2g">0</span></p>
                <p>Blocked: <span id="baSH2">0</span> | <span id="baSH2g">0</span></p>
                <p>Missed: <span id="mfSH2">0</span> | <span id="mfSH2g">0</span></p>
                <p>Saved: <span id="safSH2">0</span> | <span id="safSH2g">0</span></p>
                <p>Goals: <span id="gfSH2">0</span> | <span id="gfSH2g">0</span></p>
                <p style="padding-top: 10px"><b>Team 2 Shots</b></p>
                <p>Shots: <span id="saSH2">0</span> | <span id="saSH2g">0</span></p>
                <p>Blocked: <span id="bfSH2">0</span> | <span id="bfSH2g">0</span></p>
                <p>Missed: <span id="maSH2">0</span> | <span id="maSH2g">0</span></p>
                <p>Saved: <span id="saaSH2">0</span> | <span id="saaSH2g">0</span></p>
                <p>Goals: <span id="gaSH2">0</span> | <span id="gaSH2g">0</span></p>
                <p style="padding-top: 10px"><b>Plus minus:</b> <span id="pmSH2">0</span> | <span id="pmSH2g">0</span></p>
            </div>
        </div>
    </div>
</div>

<div id="shotmenu" class="shot-menu">
  <ul class="menu-options">
    <li class="menu-option" onclick="shotMissed()">Missed</li>
    <li class="menu-option" onclick="shotSaved()">Saved</li>
    <li class="menu-option" onclick="shotBlocked()">Blocked</li>
    <li class="menu-option" onclick="shotGoal()">Goal</li>
  </ul>
</div>

<!-- The JavaScript - code that describes the game analysis functionality -->

<script>

    // Variables

    var line_on = 1; // Line on court
    var started = 0; // Game started 0/1
    var lines = ["L1", "L2", "L3", "Pp1", "Pp2", "Sh1", "Sh2"]; // Line array
    var is_on = 0; // Game clock on 1/0
    var counter = 0; // Counter for the period time * 1000 ms
    var gameCounter = 0; // Counter for the game time * 1000 ms
    var periodN = 1; // Period number
    var Ball_pos = 1; // Ball possession Team 1/2
    var Ball_zone = 1; // Ball at the def zone (1) or att zone (2) in relation to Team 1
    var Order = 1; // Order of team and zone buttons 1/2
    var PosX = 0;
    var PosY = 0;
    var myImg = new Image();
    myImg.src = "/static/field_canvas.png";

    // Time on court by line period/game (in counters)

    var TocL1p = 0;
    var TocL2p = 0;
    var TocL3p = 0;
    var TocL1g = 0;
    var TocL2g = 0;
    var TocL3g = 0;
    var TocPP1p = 0;
    var TocPP2p = 0; 
    var TocSH1p = 0;
    var TocSH2p = 0;
    var TocPP1g = 0;
    var TocPP2g = 0; 
    var TocSH1g = 0;
    var TocSH2g = 0;
    var TocTeam_g = 0;
    var TocTeam_p = 0;

    // Ball possession by line/team period/game (in counters)

    var PosL1p = 0;
    var PosL2p = 0;
    var PosL3p = 0;
    var PosTeam_p = 0;
    var PosL1g = 0;
    var PosL2g = 0;
    var PosL3g = 0;
    var PosTeam_g = 0;
    var PosPP1g = 0;
    var PosPP1p = 0;
    var PosSH1p = 0;
    var PosSH1g = 0;
    var PosPP2g = 0;
    var PosPP2p = 0;
    var PosSH2p = 0;
    var PosSH2g = 0;

    // Arrays for easy access to variables

    var Toc_p = [TocL1p, TocL2p, TocL3p, TocPP1p, TocPP2p, TocSH1p, TocSH2p, TocTeam_p];
    var Toc_g = [TocL1g, TocL2g, TocL3g, TocPP1g, TocPP2g, TocSH1g, TocSH2g, TocTeam_g];
    var Pos_g = [PosL1p, PosL2p, PosL3p, PosPP1p, PosPP2p, PosSH1p, PosSH2p, PosTeam_p];
    var Pos_p = [PosL1g, PosL2g, PosL3g, PosPP1g, PosPP2g, PosSH1g, PosSH2g, PosTeam_g];

    // html id myCanvas to variable
    var cnvs = document.getElementById("myCanvas");
    // html id shotmenu to variable
    var menu = document.getElementById("shotmenu");

    // html ids to variables
    // Shots/goals/misses/blocks/saves for/against, turnovers, plusminus by line/team and period/game

    var sfL1p = document.getElementById("sfL1");
    var saL1p = document.getElementById("saL1");
    var bfL1p = document.getElementById("bfL1");
    var baL1p = document.getElementById("baL1");
    var gfL1p = document.getElementById("gfL1");
    var gaL1p = document.getElementById("gaL1");
    var pmL1p = document.getElementById("pmL1");
    var mfL1p = document.getElementById("mfL1");
    var maL1p = document.getElementById("maL1");
    var safL1p = document.getElementById("safL1");
    var saaL1p = document.getElementById("saaL1");
    var sfL2p = document.getElementById("sfL2");
    var saL2p = document.getElementById("saL2");
    var bfL2p = document.getElementById("bfL2");
    var baL2p = document.getElementById("baL2");
    var gfL2p = document.getElementById("gfL2");
    var gaL2p = document.getElementById("gaL2");
    var pmL2p = document.getElementById("pmL2");
    var mfL2p = document.getElementById("mfL2");
    var maL2p = document.getElementById("maL2");
    var safL2p = document.getElementById("safL2");
    var saaL2p = document.getElementById("saaL2");
    var sfL3p = document.getElementById("sfL3");
    var saL3p = document.getElementById("saL3");
    var bfL3p = document.getElementById("bfL3");
    var baL3p = document.getElementById("baL3");
    var gfL3p = document.getElementById("gfL3");
    var gaL3p = document.getElementById("gaL3");
    var pmL3p = document.getElementById("pmL3");
    var mfL3p = document.getElementById("mfL3");
    var maL3p = document.getElementById("maL3");
    var safL3p = document.getElementById("safL3");
    var saaL3p = document.getElementById("saaL3");
    var sfPP1p = document.getElementById("sfPP1");
    var saPP1p = document.getElementById("saPP1");
    var bfPP1p = document.getElementById("bfPP1");
    var baPP1p = document.getElementById("baPP1");
    var gfPP1p = document.getElementById("gfPP1");
    var gaPP1p = document.getElementById("gaPP1");
    var pmPP1p = document.getElementById("pmPP1");
    var mfPP1p = document.getElementById("mfPP1");
    var maPP1p = document.getElementById("maPP1");
    var safPP1p = document.getElementById("safPP1");
    var saaPP1p = document.getElementById("saaPP1");
    var sfPP2p = document.getElementById("sfPP2");
    var saPP2p = document.getElementById("saPP2");
    var bfPP2p = document.getElementById("bfPP2");
    var baPP2p = document.getElementById("baPP2");
    var gfPP2p = document.getElementById("gfPP2");
    var gaPP2p = document.getElementById("gaPP2");
    var pmPP2p = document.getElementById("pmPP2");
    var mfPP2p = document.getElementById("mfPP2");
    var maPP2p = document.getElementById("maPP2");
    var safPP2p = document.getElementById("safPP2");
    var saaPP2p = document.getElementById("saaPP2");
    var sfSH1p = document.getElementById("sfSH1");
    var saSH1p = document.getElementById("saSH1");
    var bfSH1p = document.getElementById("bfSH1");
    var baSH1p = document.getElementById("baSH1");
    var gfSH1p = document.getElementById("gfSH1");
    var gaSH1p = document.getElementById("gaSH1");
    var pmSH1p = document.getElementById("pmSH1");
    var mfSH1p = document.getElementById("mfSH1");
    var maSH1p = document.getElementById("maSH1");
    var safSH1p = document.getElementById("safSH1");
    var saaSH1p = document.getElementById("saaSH1");
    var sfSH2p = document.getElementById("sfSH2");
    var saSH2p = document.getElementById("saSH2");
    var bfSH2p = document.getElementById("bfSH2");
    var baSH2p = document.getElementById("baSH2");
    var gfSH2p = document.getElementById("gfSH2");
    var gaSH2p = document.getElementById("gaSH2");
    var pmSH2p = document.getElementById("pmSH2");
    var mfSH2p = document.getElementById("mfSH2");
    var maSH2p = document.getElementById("maSH2");
    var safSH2p = document.getElementById("safSH2");
    var saaSH2p = document.getElementById("saaSH2");
    var sfTeamp = document.getElementById("sfTeam");
    var saTeamp = document.getElementById("saTeam");
    var bfTeamp = document.getElementById("bfTeam");
    var baTeamp = document.getElementById("baTeam");
    var gfTeamp = document.getElementById("gfTeam");
    var gaTeamp = document.getElementById("gaTeam");
    var pmTeamp = document.getElementById("pmTeam");
    var mfTeamp = document.getElementById("mfTeam");
    var maTeamp = document.getElementById("maTeam");
    var safTeamp = document.getElementById("safTeam");
    var saaTeamp = document.getElementById("saaTeam");

    // html ids to variables
    // Possession/Time on Court/AttZone by line/team period/game

    var pL1p = document.getElementById("pL1");
    var pL2p = document.getElementById("pL2");
    var pL3p = document.getElementById("pL3");
    var pPP1p = document.getElementById("pPP1");
    var pPP2p = document.getElementById("pPP2");
    var pSH1p = document.getElementById("pSH1");
    var pSH2p = document.getElementById("pSH2");
    var pTeamp = document.getElementById("pTeam");
    var tocL1p = document.getElementById("tocL1");
    var tocL2p = document.getElementById("tocL2");
    var tocL3p = document.getElementById("tocL3");
    var tocPP1p = document.getElementById("tocPP1");
    var tocPP2p = document.getElementById("tocPP2");
    var tocSH1p = document.getElementById("tocSH1");
    var tocSH2p = document.getElementById("tocSH2");
    var tocTeamp = document.getElementById("tocTeam");

    // html ids to variables
    // Shots/goals/penalties for/against, Fenwick/ba, plusminus by line/team period/game

    var sfL1g = document.getElementById("sfL1g");
    var saL1g = document.getElementById("saL1g");
    var bfL1g = document.getElementById("bfL1g");
    var baL1g = document.getElementById("baL1g");
    var gfL1g = document.getElementById("gfL1g");
    var gaL1g = document.getElementById("gaL1g");
    var pmL1g = document.getElementById("pmL1g");
    var mfL1g = document.getElementById("mfL1g");
    var maL1g = document.getElementById("maL1g");
    var safL1g = document.getElementById("safL1g");
    var saaL1g = document.getElementById("saaL1g");
    var sfL2g = document.getElementById("sfL2g");
    var saL2g = document.getElementById("saL2g");
    var bfL2g = document.getElementById("bfL2g");
    var baL2g = document.getElementById("baL2g");
    var gfL2g = document.getElementById("gfL2g");
    var gaL2g = document.getElementById("gaL2g");
    var pmL2g = document.getElementById("pmL2g");
    var mfL2g = document.getElementById("mfL2g");
    var maL2g = document.getElementById("maL2g");
    var safL2g = document.getElementById("safL2g");
    var saaL2g = document.getElementById("saaL2g");
    var sfL3g = document.getElementById("sfL3g");
    var saL3g = document.getElementById("saL3g");
    var bfL3g = document.getElementById("bfL3g");
    var baL3g = document.getElementById("baL3g");
    var gfL3g = document.getElementById("gfL3g");
    var gaL3g = document.getElementById("gaL3g");
    var pmL3g = document.getElementById("pmL3g");
    var mfL3g = document.getElementById("mfL3g");
    var maL3g = document.getElementById("maL3g");
    var safL3g = document.getElementById("safL3g");
    var saaL3g = document.getElementById("saaL3g");
    var sfPP1g = document.getElementById("sfPP1g");
    var saPP1g = document.getElementById("saPP1g");
    var bfPP1g = document.getElementById("bfPP1g");
    var baPP1g = document.getElementById("baPP1g");
    var gfPP1g = document.getElementById("gfPP1g");
    var gaPP1g = document.getElementById("gaPP1g");
    var pmPP1g = document.getElementById("pmPP1g");
    var mfPP1g = document.getElementById("mfPP1g");
    var maPP1g = document.getElementById("maPP1g");
    var safPP1g = document.getElementById("safPP1g");
    var saaPP1g = document.getElementById("saaPP1g");
    var sfPP2g = document.getElementById("sfPP2g");
    var saPP2g = document.getElementById("saPP2g");
    var bfPP2g = document.getElementById("bfPP2g");
    var baPP2g = document.getElementById("baPP2g");
    var gfPP2g = document.getElementById("gfPP2g");
    var gaPP2g = document.getElementById("gaPP2g");
    var pmPP2g = document.getElementById("pmPP2g");
    var mfPP2g = document.getElementById("mfPP2g");
    var maPP2g = document.getElementById("maPP2g");
    var safPP2g = document.getElementById("safPP2g");
    var saaPP2g = document.getElementById("saaPP2g");
    var sfSH1g = document.getElementById("sfSH1g");
    var saSH1g = document.getElementById("saSH1g");
    var bfSH1g = document.getElementById("bfSH1g");
    var baSH1g = document.getElementById("baSH1g");
    var gfSH1g = document.getElementById("gfSH1g");
    var gaSH1g = document.getElementById("gaSH1g");
    var pmSH1g = document.getElementById("pmSH1g");
    var mfSH1g = document.getElementById("mfSH1g");
    var maSH1g = document.getElementById("maSH1g");
    var safSH1g = document.getElementById("safSH1g");
    var saaSH1g = document.getElementById("saaSH1g");
    var sfSH2g = document.getElementById("sfSH2g");
    var saSH2g = document.getElementById("saSH2g");
    var bfSH2g = document.getElementById("bfSH2g");
    var baSH2g = document.getElementById("baSH2g");
    var gfSH2g = document.getElementById("gfSH2g");
    var gaSH2g = document.getElementById("gaSH2g");
    var pmSH2g = document.getElementById("pmSH2g");
    var mfSH2g = document.getElementById("mfSH2g");
    var maSH2g = document.getElementById("maSH2g");
    var safSH2g = document.getElementById("safSH2g");
    var saaSH2g = document.getElementById("saaSH2g");
    var sfTeamg = document.getElementById("sfTeamg");
    var saTeamg = document.getElementById("saTeamg");
    var bfTeamg = document.getElementById("bfTeamg");
    var baTeamg = document.getElementById("baTeamg");
    var gfTeamg = document.getElementById("gfTeamg");
    var gaTeamg = document.getElementById("gaTeamg");
    var pmTeamg = document.getElementById("pmTeamg");
    var mfTeamg = document.getElementById("mfTeamg");
    var maTeamg = document.getElementById("maTeamg");
    var safTeamg = document.getElementById("safTeamg");
    var saaTeamg = document.getElementById("saaTeamg");
    var pL1g = document.getElementById("pL1g");
    var pL2g = document.getElementById("pL2g");
    var pL3g = document.getElementById("pL3g");
    var pPP1g = document.getElementById("pPP1g");
    var pPP2g = document.getElementById("pPP2g");
    var pSH1g = document.getElementById("pSH1g");
    var pSH2g = document.getElementById("pSH2g");
    var pTeamg = document.getElementById("pTeamg");
    var tocL1g = document.getElementById("tocL1g");
    var tocL2g = document.getElementById("tocL2g");
    var tocL3g = document.getElementById("tocL3g");
    var tocPP1g = document.getElementById("tocPP1g");
    var tocPP2g = document.getElementById("tocPP2g");
    var tocSH1g = document.getElementById("tocSH1g");
    var tocSH2g = document.getElementById("tocSH2g");
    var tocTeamg = document.getElementById("tocTeamg");

    // Arrays for easy access to variables

    var sf_p = [sfL1p, sfL2p, sfL3p, sfPP1p, sfPP2p, sfSH1p, sfSH2p, sfTeamp];
    var sa_p = [saL1p, saL2p, saL3p, saPP1p, saPP2p, saSH1p, saSH2p, saTeamp];
    var gf_p = [gfL1p, gfL2p, gfL3p, gfPP1p, gfPP2p, gfSH1p, gfSH2p, gfTeamp];
    var ga_p = [gaL1p, gaL2p, gaL3p, gaPP1p, gaPP2p, gaSH1p, gaSH2p, gaTeamp];
    var pm_p = [pmL1p, pmL2p, pmL3p, pmPP1p, pmPP2p, pmSH1p, pmSH2p, pmTeamp];
    var bf_p = [bfL1p, bfL2p, bfL3p, bfPP1p, bfPP2p, bfSH1p, bfSH2p, bfTeamp];
    var ba_p = [baL1p, baL2p, baL3p, baPP1p, baPP2p, baSH1p, baSH2p, baTeamp];
    var mf_p = [mfL1p, mfL2p, mfL3p, mfPP1p, mfPP2p, mfSH1p, mfSH2p, mfTeamp];
    var ma_p = [maL1p, maL2p, maL3p, maPP1p, maPP2p, maSH1p, maSH2p, maTeamp];
    var saf_p = [safL1p, safL2p, safL3p, safPP1p, safPP2p, safSH1p, safSH2p, safTeamp];
    var saa_p = [saaL1p, saaL2p, saaL3p, saaPP1p, saaPP2p, saaSH1p, saaSH2p, saaTeamp];
    var p_p = [pL1p, pL2p, pL3p, pPP1p, pPP2p, pSH1p, pSH2p, pTeamp];
    var toc_p = [tocL1p, tocL2p, tocL3p, tocPP1p, tocPP2p, tocSH1p, tocSH2p, tocTeamp];
    
    var sf_g = [sfL1g, sfL2g, sfL3g, sfPP1g, sfPP2g, sfSH1g, sfSH2g, sfTeamg];
    var sa_g = [saL1g, saL2g, saL3g, saPP1g, saPP2g, saSH1g, saSH2g, saTeamg];
    var gf_g = [gfL1g, gfL2g, gfL3g, gfPP1g, gfPP2g, gfSH1g, gfSH2g, gfTeamg];
    var ga_g = [gaL1g, gaL2g, gaL3g, gaPP1g, gaPP2g, gaSH1g, gaSH2g, gaTeamg];
    var pm_g = [pmL1g, pmL2g, pmL3g, pmPP1g, pmPP2g, pmSH1g, pmSH2g, pmTeamg];
    var bf_g = [bfL1g, bfL2g, bfL3g, bfPP1g, bfPP2g, bfSH1g, bfSH2g, bfTeamg];
    var ba_g = [baL1g, baL2g, baL3g, baPP1g, baPP2g, baSH1g, baSH2g, baTeamg];
    var mf_g = [mfL1g, mfL2g, mfL3g, mfPP1g, mfPP2g, mfSH1g, mfSH2g, mfTeamg];
    var ma_g = [maL1g, maL2g, maL3g, maPP1g, maPP2g, maSH1g, maSH2g, maTeamg];
    var saf_g = [safL1g, safL2g, safL3g, safPP1g, safPP2g, safSH1g, safSH2g, safTeamg];
    var saa_g = [saaL1g, saaL2g, saaL3g, saaPP1g, saaPP2g, saaSH1g, saaSH2g, saaTeamg];
    var p_g = [pL1g, pL2g, pL3g, pPP1g, pPP2g, pSH1g, pSH2g, pTeamg];
    var toc_g = [tocL1g, tocL2g, tocL3g, tocPP1g, tocPP2g, tocSH1g, tocSH2g, tocTeamg];

    // Load and draw the shot map image when the html-page is loaded
    window.onload = function() {
    var ctx = cnvs.getContext("2d");
    ctx.drawImage(myImg,0,0,284,200);
    }

    // When the change team order button is changed, the teams switch sides
    function ChangeOrder() {
        if (Order == 1) { // Team 1 is moved as the right one, defence zone on the right
            document.getElementById("TeamL").innerHTML = "Team 2";
            document.getElementById("TeamR").innerHTML = "Team 1";
            Order = 2;
        }
        else { // Team 1 is moved as the left one, defence zone on the left
            document.getElementById("TeamL").innerHTML = "Team 1";
            document.getElementById("TeamR").innerHTML = "Team 2";
            Order = 1;
        }
    }

    // When the ball team left button is pressed the button colors and the variable are changed
    // If game is on, them turnover is added
    function BallTeamL() {
        document.getElementById("TeamR").style.background='#4CAF50';
        document.getElementById("TeamL").style.background='#555555';
        if (Order == 1) {
            Ball_pos = 1;

        } else {
            Ball_pos = 2;

        }
    }

    // When the ball team right button is pressed
    function BallTeamR() {
        document.getElementById("TeamR").style.background='#555555';
        document.getElementById("TeamL").style.background='#4CAF50';
        if (Order == 1) {
            Ball_pos = 2;

        }

        else {
            Ball_pos = 1;

        }
    }

    // When the Odd Man Rush - button is pressed
    function OddManRush() {

    }
    // When the Scoring Opportunity - button is pressed
    function ScoringOpp() {

    }
    // When the line is changed by pressing any of the line on court buttons except the one that is on
    function Line_change(line) {
        console.log(lines); // debugging
        document.getElementById(lines[line_on-1]).style.background='#4CAF50';
        document.getElementById(lines[line-1]).style.background='#555555';
        line_on = line;
        console.log(line_on); // debugging
    }
    // Start game or start/stop game clock
    function Start() {
        // If the game has not started
        if (started == 0) {   // Start game and disable teams etc.
            var r = confirm("Do you want to start the game,\n changing teams will be disabled?");
            if (r == true) {
                document.getElementById("home_team").disabled = true;
                document.getElementById("away_team").disabled = true;
                document.getElementById("period").disabled = false;
                document.getElementById("reset").disabled = false;
                started = 1;
            } else {
            }
        }
        // Game has already started, then start/stop the game clock
        else {
            if (is_on == 0) {    // Start game clock
               document.getElementById("start").innerHTML = "Stop";
               document.getElementById("start").style.background='#555555';
               is_on = 1;
               Counter();
            }
            else if (is_on == 1) {  // Stop game clock
                document.getElementById("start").innerHTML = "Start";
                document.getElementById("start").style.background='#4CAF50';
                is_on = 0;
            }
        }
    }
    // Press the Reset button
    function Reset() {

    }
    // Press the Period button
    function Period() {
        var r = confirm("Changing period will reset clock and statistics,\nand save data, are you sure?");
            if (r == true) {
                periodN++
                counter = 1;
                document.getElementById("periodNr").innerHTML = "Period " + periodN;
                document.getElementById("label").innerHTML = "00:00:00";

                var ctx = cnvs.getContext("2d");
                ctx.drawImage(myImg,0,0,284,200);

                for (let i = 0; i < 8; i++) {

                    sf_p[i].innerHTML = 0;
                    sa_p[i].innerHTML = 0;
                    gf_p[i].innerHTML = 0;
                    ga_p[i].innerHTML = 0;
                    pm_p[i].innerHTML = 0;
                    bf_p[i].innerHTML = 0;
                    ba_p[i].innerHTML = 0;
                    mf_p[i].innerHTML = 0;
                    ma_p[i].innerHTML = 0;
                    saf_p[i].innerHTML = 0;
                    saa_p[i].innerHTML = 0;

                    Pos_p[i] = 0;
                    Toc_p[i] = 0;

                    p_p[i].innerHTML = 0;
                    toc_p[i].innerHTML = "00:00";
                }

            } else {
            }
    }
    function Counter() {
        t = setTimeout(function(){ Count() }, 1000);
    }

    function Count() {
         if (is_on == 1) {

             Toc_p[line_on - 1]++;
             Toc_g[line_on - 1]++;
             Toc_p[7]++;
             Toc_g[7]++;

             if (Ball_pos == 1) {
                Pos_p[line_on - 1]++;
                Pos_g[line_on - 1]++;
                Pos_g[7]++;
                Pos_p[7]++;

             }
             else {

             }
             
             p_p[line_on - 1].innerHTML = Math.round(100 * Pos_p[line_on - 1] / Toc_p[line_on - 1]);
             p_p[7].innerHTML = Math.round(100 * Pos_p[7] / counter);
             
             p_g[line_on - 1].innerHTML = Math.round(100 * Pos_g[line_on - 1] / Toc_g[line_on - 1]);
             p_g[7].innerHTML = Math.round(100 * Pos_g[7] / gameCounter);

             var toc = new Date(Toc_p[line_on - 1] * 1000);
             var d = toc.toISOString().substr(14, 5);
             toc_p[line_on - 1].innerHTML = d;
             
             var toc = new Date(Toc_g[line_on - 1] * 1000);
             var d = toc.toISOString().substr(14, 5);
             toc_g[line_on - 1].innerHTML = d;

             var toc = new Date(Toc_p[7] * 1000);
             var d = toc.toISOString().substr(14, 5);
             toc_p[7].innerHTML = d;

             var toc = new Date(Toc_g[7] * 1000);
             var d = toc.toISOString().substr(14, 5);
             toc_g[7].innerHTML = d;

             counter++;
             gameCounter++;
             console.log(counter);
             
             var date = new Date(counter * 1000);
             var display = date.toISOString().substr(11, 8);
             document.getElementById("label").innerHTML = display;

             t = setTimeout(function(){ Count() }, 1000);
         }
    }

    function FindPosition(oElement)
    {
      if(typeof( oElement.offsetParent ) != "undefined")
      {
        for(var posX = 0, posY = 0; oElement; oElement = oElement.offsetParent)
        {
          posX += oElement.offsetLeft;
          posY += oElement.offsetTop;
        }
          return [ posX, posY ];
        }
        else
        {
          return [ oElement.x, oElement.y ];
        }
    }

    function GetCoordinates(e)
    {
        var ImgPos;
        ImgPos = FindPosition(cnvs);
        if (!e) var e = window.event;
        if (e.pageX || e.pageY)
        {
        PosX = e.pageX;
        PosY = e.pageY;
        }
        else if (e.clientX || e.clientY)
        {
          PosX = e.clientX + document.body.scrollLeft
            + document.documentElement.scrollLeft;
          PosY = e.clientY + document.body.scrollTop
            + document.documentElement.scrollTop;
        }

        menu.style.display = "block";
        if (PosX <= 284/2)
        {
            menu.style.left = PosX + "px";
        }
        else
        {
            menu.style.left = (PosX-100) + "px";
        }
        menu.style.top = PosY + "px";

        PosX = PosX - ImgPos[0];
        PosY = PosY - ImgPos[1];
    }

    function shotMissed() {
        Draw(PosX,PosY,1);
    }

    function shotBlocked() {
        Draw(PosX,PosY,2);
    }

    function shotSaved() {
        Draw(PosX,PosY,3);
    }

    function shotGoal() {
        Draw(PosX,PosY,4);
    }

    function Draw(x,y,type)
    {
        var ctx = cnvs.getContext("2d");
        menu.style.display = "none";
        ctx.font = "12px Arial";

        if (Ball_pos == 1) {
            ctx.fillStyle = "blue";
            if (type == 1) {    // Shot Missed
                ctx.fillText("M", x, y);
                
                sf_p[line_on - 1].innerHTML++;
                sf_p[7].innerHTML++;
                sf_g[line_on - 1].innerHTML++;
                sf_g[7].innerHTML++;

                mf_p[line_on - 1].innerHTML++;
                mf_p[7].innerHTML++;
                mf_g[line_on - 1].innerHTML++;
                mf_g[7].innerHTML++;
            }
            else if (type == 2) {   // Shot Blocked
                ctx.fillText("B", x, y);
                
                sf_p[line_on - 1].innerHTML++;
                sf_p[7].innerHTML++;
                sf_g[line_on - 1].innerHTML++;
                sf_g[7].innerHTML++;

                ba_g[line_on - 1].innerHTML++;
                ba_g[7].innerHTML++;
                ba_p[line_on - 1].innerHTML++;
                ba_p[7].innerHTML++;
            }
            else if (type == 3) {   // Shot Saved
                ctx.fillText("S", x, y);
                
                sf_p[line_on - 1].innerHTML++;
                sf_p[7].innerHTML++;
                sf_g[line_on - 1].innerHTML++;
                sf_g[7].innerHTML++;

                saf_p[line_on - 1].innerHTML++;
                saf_p[7].innerHTML++;
                saf_g[line_on - 1].innerHTML++;
                saf_g[7].innerHTML++;
            }
            else if (type == 4) {   // Shot Goal
                ctx.fillText("G", x, y);
                
                sf_p[line_on - 1].innerHTML++;
                gf_p[line_on - 1].innerHTML++;
                pm_p[line_on - 1].innerHTML++;
                sf_p[7].innerHTML++;
                gf_p[7].innerHTML++;
                pm_p[7].innerHTML++;
                
                sf_g[line_on - 1].innerHTML++;
                gf_g[line_on - 1].innerHTML++;
                pm_g[line_on - 1].innerHTML++;
                sf_g[7].innerHTML++;
                gf_g[7].innerHTML++;
                pm_g[7].innerHTML++;
            }
        }
        else if (Ball_pos == 2) {
            ctx.fillStyle = "red";
            if (type == 1) {    // Shot Missed
                ctx.fillText("M", x, y);
                
                sa_p[line_on - 1].innerHTML++;
                sa_p[7].innerHTML++;
                sa_g[line_on - 1].innerHTML++;
                sa_g[7].innerHTML++;

                ma_p[line_on - 1].innerHTML++;
                ma_p[7].innerHTML++;
                ma_g[line_on - 1].innerHTML++;
                ma_g[7].innerHTML++;
            }
            else if (type == 2) {   // Shot Blocked
                ctx.fillText("B", x, y);
                
                sa_p[line_on - 1].innerHTML++;
                bf_p[line_on - 1].innerHTML++;
                sa_p[7].innerHTML++;
                bf_p[7].innerHTML++;
                
                sa_g[line_on - 1].innerHTML++;
                bf_g[line_on - 1].innerHTML++;
                sa_g[7].innerHTML++;
                bf_g[7].innerHTML++;
            }
            else if (type == 3) {   // Shot Saved
                ctx.fillText("S", x, y);
                
                sa_p[line_on - 1].innerHTML++;
                sa_p[7].innerHTML++;
                sa_g[line_on - 1].innerHTML++;
                sa_g[7].innerHTML++;

                saa_p[line_on - 1].innerHTML++;
                saa_p[7].innerHTML++;
                saa_g[line_on - 1].innerHTML++;
                saa_g[7].innerHTML++;
            }
            else if (type == 4) {   // Shot Goal
                ctx.fillText("G", x, y);
                
                sa_p[line_on - 1].innerHTML++;
                ga_p[line_on - 1].innerHTML++;
                pm_p[line_on - 1].innerHTML--;
                sa_p[7].innerHTML++;
                ga_p[7].innerHTML++;
                pm_p[7].innerHTML--;
                
                sa_g[line_on - 1].innerHTML++;
                ga_g[line_on - 1].innerHTML++;
                pm_g[line_on - 1].innerHTML--;
                sa_g[7].innerHTML++;
                ga_g[7].innerHTML++;
                pm_g[7].innerHTML--;
            }
        }
    }

</script>

{% endblock %}